---
title: "In class exercise 6 Answer Key"
output: html_document
---

```{r,echo=F}
knitr::opts_chunk$set(message=F,warning=F)
```

Estimate the model 

$$ math = \beta_0 + \beta_1 * lunch + u$$

Compute the heteroskedasticity-robust standard error for $\hat{\beta}_1$, and 1. construct a 95% confidence interval for $\beta_1$ based on that; 2. Test the hypothesis of $H_0: \beta_1=-0.5$ vs $H_1: \beta_1\neq -0.5$ at 5% significance level.

First, the regression itself. 
```{r}
require(tidyverse)
require(magrittr)
require(ggplot2)
ca_school_url = "https://raw.githubusercontent.com/f1kidd/Econ184/main/Data/CASchools.csv"
data = read_csv(ca_school_url)
data %<>% mutate(STR = students/teachers,
                 test.score = (read+math)/2)
lm1 = lm(math~lunch,data=data)
```

The HC-robust standard error is given by:
```{r}
library(lmtest)
library(sandwich)
cft1 = coeftest(lm1)
cft1
```
Mathematically, the 95% confidence interval of $\beta_1$ is $[\hat{\beta}_1-1.96SE(\hat{\beta}_1), \hat{\beta}_1+1.96SE(\hat{\beta}_1)]$. Using R as a calculator, 

```{r}
conf_int95 = c(cft1[2,1]-1.96*cft1[2,2],cft1[2,1]+1.96*cft1[2,2])
conf_int95 %<>% round(3)
conf_int95
```
we have the 95% confidence interval at [`r conf_int95[1]`,`r conf_int95[2]`].

Finally, since the 95% confidence interval does not cover -0.5, we can reject the hypothesis that $\beta_1=-0.5$ at 5% significance level.
